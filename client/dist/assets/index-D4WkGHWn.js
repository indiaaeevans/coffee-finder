(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function c(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(e){if(e.ep)return;e.ep=!0;const n=c(e);fetch(e.href,n)}})();const R="https://coffee-finder-api.onrender.com",W=["Starbucks","Dunkin","Costa Coffee","Tim Hortons","Caribou Coffee"],Z=`${R}/api/v1/geo/places`,j=`${R}/api/v1/geo/reverse`,K=`${R}/api/v1/geo/forward`,Y=r=>Math.round(r*1609.34),J=r=>(r/1609.34).toFixed(2),Q=(r,s)=>{let c;return function(...d){c||(r.apply(this,d),c=!0,setTimeout(()=>c=!1,s))}},X=r=>W.some(s=>r.toLowerCase().includes(s.toLowerCase())),ee=async(r,s)=>{const c=new URL(j),d=new URLSearchParams({latitude:r,longitude:s});c.search=d.toString();const e=await fetch(c.toString());if(!e.ok)throw new Error("Network response was not ok");const n=await e.json();if(!n.results||n.results.length===0)throw new Error(`Unable to find address for coordinates: ${r}, ${s}`);return n.results[0].address_line1},te=async r=>{const s=new URL(K),c=new URLSearchParams({address:r});s.search=c.toString();const d=await fetch(s.toString());if(!d.ok)throw new Error("Network response was not ok");const e=await d.json();if(!e.results||e.results.length===0)throw new Error(`Unable to find coordinates for address: ${r}`);return{latitude:e.results[0].lat,longitude:e.results[0].lon,address:e.results[0].address_line1}},oe=async(r,s,c,d)=>{const e=new URL(Z),n=new URLSearchParams({longitude:r,latitude:s,radius:c,limit:d});e.search=n.toString();const l=await fetch(e.toString());if(!l.ok)throw new Error("Network response was not ok");return(await l.json()).features.map(f=>({...f,properties:{...f.properties,indie:!X(f.properties.name)}}))},ne=35.994034,re=-78.898621,z=12,se="images/location.svg",ie="images/skull.svg",ae="images/coffee.svg",ce="https://tile.openstreetmap.org/{z}/{x}/{y}.png",le='&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>';let p,k,de=20,b,E;document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("coffee-form"),s=document.getElementById("coffee-form__use-current-location"),c=document.getElementById("coffee-form__starting-location"),d=document.getElementById("coffee-form__max-radius"),e=document.getElementById("results-list"),n=document.querySelector(".results-summary__results-count"),l=document.querySelector(".results-container"),I=document.getElementById("filter-switch"),f=document.querySelector(".toggle-results"),U=document.querySelector(".toggle-results-wrapper"),g=document.getElementById("coffee-form__starting-location-err"),T=document.querySelector(".loading-wrapper");f.addEventListener("click",function(){l.classList.toggle("expanded"),l.classList.contains("expanded")?f.textContent="Collapse list view":f.textContent="Expand list view"}),I.addEventListener("click",function(){const o=this.getAttribute("aria-checked")==="true";this.setAttribute("aria-checked",String(!o))});function O(){l.classList.contains("expanded")||(l.scrollHeight>l.clientHeight?U.style.display="block":U.style.display="none")}function x(){T.classList.remove("hidden")}function A(){T.classList.add("hidden")}function P(){g.textContent="",g.classList.add("hidden")}window.addEventListener("resize",Q(O,250));function M(o=ne,i=re,a=z){p=L.map("map",{zoomControl:!1}).setView([o,i],a),L.control.zoom({position:"bottomright"}).addTo(p),L.tileLayer(ce,{maxZoom:19,attribution:le}).addTo(p),E=L.layerGroup([]),L.Control.CustomControl=L.Control.extend({onAdd:function(m){var t=L.DomUtil.get("coffee-form");return L.DomEvent.disableClickPropagation(t),t.style.display="block",t}}),L.control.customControl=function(m){return new L.Control.CustomControl(m)},L.control.customControl({position:"topleft"}).addTo(p)}(async()=>{try{x();const{latitude:o,longitude:i}=await D();M(o,i)}catch(o){console.error("Failed to get current location: ",o),console.info("Setting map to default location."),M()}finally{A()}})();const B=L.icon({iconUrl:se,mapIconColor:"#cc756b",iconSize:[32,32],popupAnchor:[0,-16]}),q=L.icon({iconUrl:ie,iconSize:[28,28],popupAnchor:[0,-16]}),G=L.icon({iconUrl:ae,iconSize:[32,32],popupAnchor:[0,-16]});function H(){l.classList.add("hidden"),k&&p.removeLayer(k),E.removeFrom(p),E.clearLayers(),e.innerHTML=""}function V(o,i){if(o.length===0){n.textContent=`No coffee shops found within ${i} ${i>1?"miles":"mile"}.`,l.classList.remove("hidden");return}const a=document.createElement("ul");o.forEach(t=>{const y=document.createElement("li"),w=t.properties.name,C=J(t.properties.distance),v=t.properties.indie;y.classList.add(v?"indie":"chain");const u=document.createElement(t.properties.website?"a":"span");u.textContent=w,t.properties.website&&(u.href=t.properties.website,u.target="_blank");const h=document.createElement("span");h.appendChild(u),h.appendChild(document.createElement("br"));const S=document.createElement("span");S.classList.add("distance"),S.textContent=`${C} miles`,h.appendChild(S),y.appendChild(h),a.appendChild(y);let F=L.marker([t.properties.lat,t.properties.lon],{icon:v?G:q});const $=document.createElement("div"),_=document.createElement(t.properties.website?"a":"span");_.textContent=w,t.properties.website&&(_.href=t.properties.website,_.target="_blank"),$.appendChild(_),F.bindPopup($),E.addLayer(F)}),E.addTo(p);let m=E.getLayers().map(t=>t.getLatLng()).map(t=>[t.lat,t.lng]);p.flyToBounds(m,{padding:[50,50],maxZoom:15}),n.textContent=`Found ${o.length} coffee shop${o.length!==1?"s":""}.`,e.appendChild(a),l.classList.remove("hidden"),O()}async function D(){return new Promise(function(o,i){"geolocation"in navigator?navigator.geolocation.getCurrentPosition(a=>{const m=a.coords.latitude,t=a.coords.longitude;o({latitude:m,longitude:t})},a=>{console.error(a),i("Geolocation permissions may be turned off...")}):i("Geolocation is not supported by your browser.")})}s.addEventListener("click",async()=>{try{P();const{latitude:o,longitude:i}=await D(),a=await ee(o,i);c.value=a,N(o,i,a),p.flyTo([o,i],z)}catch(o){console.error("Failed to get current location: ",o),g.textContent="Failed to get current location. Please try again with location services enabled.",g.classList.remove("hidden")}});function N(o,i,a){b&&b.removeFrom(p),b=L.marker([o,i],{icon:B}).addTo(p),b.bindPopup(a)}r.addEventListener("submit",async o=>{o.preventDefault(),H(),x();const i=c.value;let a;try{a=await te(i)}catch(u){console.error("Error fetching coordinates:",u),g.textContent="Failed to locate your address. Please try again.",g.classList.remove("hidden"),A();return}P();const{latitude:m,longitude:t,address:y}=a;N(m,t,y);const w=d.value,C=Y(w),v=I.getAttribute("aria-checked")==="true";k=L.circle([m,t],{color:"#ED4A49",fillColor:"#ED4A49",fillOpacity:.1,radius:C}).addTo(p);try{let u=await oe(t,m,C,de);v&&(u=u.filter(h=>h.properties.indie)),V(u,w)}catch(u){console.error("Error fetching nearby places:",u)}finally{A()}})});
//# sourceMappingURL=index-D4WkGHWn.js.map
